(function(){window.params={};var d=window.location.search.substr(1).split("&");for(var g=0,f=d.length;g<f;g++){var e=d[g];if(e.length==0){continue}var c=e.split("=");if(c.length==0||c[0].length==0){continue}window.params[c[0]]=c[1]||null}window.makeurl=function(a){var b={},i=[];for(var h in window.params){b[h]=window.params[h]}for(var h in a){b[h]=a[h]}for(var h in b){i.push(h+(!!b[h]?"="+b[h]:""))}return window.baseurl+"?"+i.join("&")}})();$(function(){window.isHome=($("#tweets").length==0);if(window.widgetUrl){window.tweetUrl=window.makeurl({r:"main/widgettweets",user:window.user,list:window.list,hours:window.hours})}else{if(window.noautorefresh){window.tweetUrl=""}else{window.tweetUrl=window.makeurl({r:"main/tweets",user:window.user,list:window.list,hours:window.hours})}}window.portalUrl=window.makeurl({r:"main/portals",count:(isHome?3:3)})});function linkify(a){if(typeof a!="string"){return""}a=a.replace(/(https?:\/\/[^\s]+)/i,"<a href='$1' class='ext' target='_blank' rel='nofollow'>$1</a>");a=a.replace(/(^|[\s,\.])@([A-Za-z0-9_]+)/g,"$1@<a href=\"http://twitter.com/$2\" target='_blank'>$2</a>");a=a.replace(/(^|[\s,\.])#([A-Za-z0-9_]+)/g,"$1#<a href=\"http://search.twitter.com/search?had_popular=true&q=$2\" target='_blank'>$2</a>");return a}function toggleTweetByID(b){$("div.preview[id!=pre"+b+"]").hide();$("div.body[id!=tw"+b+"]").removeClass("selected");var a=$("div#pre"+b);$("div.loader",a).show();return a}function postToggle(g,c){var b=$("div#tw"+g);if(c.css("display")=="none"){b.removeClass("selected")}else{b.addClass("selected");var f=$("#pre"+g).offset().top;var e=$(document).scrollTop()+$(window).height()-20;if(f>e){$("html,body").scrollTop(f-$(window).height()+$("#tw"+g).height())}if(c.attr("rel")=="done"){$("div.loader",c).hide();return}var d={r:"main/lookup",id:g};var a=$("td.text a.url",b).attr("href");if(a.length>0&&a.indexOf("http://")==0){d.url=escape(a)}$.get(window.makeurl(d),function(h){$("div.loader",c).hide();$(":not(:first-child)",c).remove();c.append(h);$("span.replybt",c).click(replyTweet)},"html");c.attr("rel","done")}}function reloadTweet(){$.get(tweetUrl,function(a){if(a.length>10){$("#leftpane").html(a);initTweetUI()}},"html")}function reloadPortal(){$.get(portalUrl,function(a){if(a.length>10){$("#rightpane").html(a);initPortalUI()}},"html")}function handleTap(c){if($(c.target)[0].tagName.toLowerCase()=="a"||$(c.target.parentNode)[0].tagName.toLowerCase()=="a"){if($(c.target).hasClass("ext")){c.preventDefault();var a=$(c.target).parentsUntil("div.body")[0];$(a).click()}else{c.stopPropagation()}return}var d=$("span.prevbt,span.respbt",$(this)).attr("id").replace(/^(prev|resp)_/,"");var b=toggleTweetByID(d);b.toggle();postToggle(d,b)}function replyTweet(b){b.preventDefault();if(typeof window.loggedinuser=="undefined"){modal.info("not logged in... login with twitter to post reply and retweet");window.location="/login";return false}var a=$(this).parentsUntil("div.body,div.msg,div.tweetcontent").last().parent();var d=a.attr("id").substr(2);var c=$("span.user",a).html();modal.prompt("replying to "+c,"@"+c+" ",function(e){modal.loader.show("posting your reply");$.post(baseurl+"reply.php",{tweet_id:d,tweet_text:e},function(f){if(f.response==200){modal.info("reply posted")}else{if(f.response==400){modal.info("not logged in")}else{modal.info("some issue posting your reply")}}modal.loader.hide()})});return false}function retweet(b){b.preventDefault();if(typeof window.loggedinuser=="undefined"){modal.info("not logged in... login with twitter to post reply and retweet");window.location="/login";return false}var a=$(this).parentsUntil("div.body,div.tweetcontent").last().parent();var c=a.attr("id").substr(2);modal.confirm("do you wanna retweet this?",function(){modal.loader.show("posting the retweet");$.post(baseurl+"retweet.php?tweet_id="+c,function(d){if(d.response==200){modal.info("retweet posted")}else{if(d.response==400){modal.info("not logged in")}else{modal.info("some issue posting your reply")}}modal.loader.hide()})});return false}function showmore(g){g.preventDefault();$("div.child").slideUp("slow");var a=$("a.moreofuser");for(var c=0;c<a.length;c++){var d=$(a)[c];if(this!=d){$(d).attr("show","more");var b=$(d).attr("cnt")+" more&gt;&gt;&nbsp;&nbsp;";$(d).html(b)}}var h=$(this).parent().parent().parent().parent().parent().nextUntil("div.parent");var f=$(this).attr("show");for(var c=0;c<h.length;c++){var d=$(h)[c];if($(d).hasClass("child")){if(f=="more"){$(d).slideDown("slow")}else{$(d).slideUp("slow")}}}if(f=="more"){$(this).attr("show","less");$(this).html("less&lt;&lt;&nbsp;&nbsp;")}else{$(this).attr("show","more");var b=$(this).attr("cnt")+" more&gt;&gt;&nbsp;&nbsp;";$(this).html(b)}};